\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[american]{babel}
\usepackage[margin=1in]{geometry}
\usepackage{mathtools}
\usepackage{fancyhdr}
\usepackage{tikz}
\usetikzlibrary{shapes, calc}
\setlength{\headheight}{15.2pt}
\pagestyle{fancy}
\lhead[]{Joseph Petitti}
\rhead[]{Homework 2}
\chead[]{Database Systems II}

\begin{document}

\section*{Problem 1}

\subsection*{(a) LRU Replacement Policy}

\begin{table}[h]
	\centering
	\begin{tabular}{l c c c c c c c c c c c c c c c}
		Instruction: & 1* & 2* & 3* & \underline{1} & 4* & 5* & \underline{3} &
		\underline{4} & 1 & 6 & 7 & 8* & 9* & 5 & 10 \\
		\hline
		Frame 1 & \textbf{1} & \textbf{1} & \textbf{1} & 1 & 1 & 1 & 1 & 1 & 1 &
		1 & 1 & 1 & 1 & 1 & 10 \\
		Frame 2 & & \textbf{2} & \textbf{2} & \textbf{2} & \textbf{2} &
		\textbf{2} & \textbf{2} & \textbf{2} & \textbf{2} & \textbf{2} &
		\textbf{2} & \textbf{2} & \textbf{2} & \textbf{2} & \textbf{2} \\
		Frame 3 & & & \textbf{3} & \textbf{3} & \textbf{3} & \textbf{3} & 3 & 3
		& 3 & 3 & 3 & \textbf{8} & \textbf{8} & \textbf{8} & \textbf{8} \\
		Frame 4 & & & & & \textbf{4} & \textbf{4} & \textbf{4} & 4 & 4 & 4 & 4 &
		4 & \textbf{9} & \textbf{9} & \textbf{9} \\
		Frame 5 & & & & & & \textbf{5} & \textbf{5} & \textbf{5} & \textbf{5} &
		\textbf{5} & \textbf{5} & \textbf{5} & \textbf{5} & \textbf{5} &
		\textbf{5} \\
		Frame 6 & & & & & & & & & & 6 & 6 & 6 & 6 & 6 & 6 \\
		Frame 7 & & & & & & & & & & & 7 & 7 & 7 & 7 & 7 \\
	\end{tabular}
\end{table}

Note: pages in bold are pinned.

\subsection*{(b) Clock Replacement Policy}

Note: a subscrpt \textit{p} indicates that a page is pinned, and a subscript
\textit{r} indicates that the reference bit is set to 1.

{
\centering

\subsubsection*{1*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{pr}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (second);
\end{tikzpicture}

\subsubsection*{2*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{pr}$};
		{\textbf{\textit{1}}};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
		{\textbf{\textit{2}}};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (third);
\end{tikzpicture}

\subsubsection*{3*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{pr}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (fourth);
\end{tikzpicture}

\subsubsection*{\underline{1}}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (fourth);
\end{tikzpicture}

\subsubsection*{4*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{pr}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (fifth);
\end{tikzpicture}

\subsubsection*{5*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{pr}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (sixth);
\end{tikzpicture}

\subsubsection*{\underline{3}}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{r}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{pr}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (sixth);
\end{tikzpicture}

\subsubsection*{\underline{4}}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{r}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{r}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (sixth);
\end{tikzpicture}

\subsubsection*{1}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{r}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{r}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{ };
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (sixth);
\end{tikzpicture}

\subsubsection*{6}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{r}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{r}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{$6_{r}$};
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{ };

	\draw[->, very thick, >=latex] (maintopic) -- (seventh);
\end{tikzpicture}

\subsubsection*{7}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$1_{r}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3_{r}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4_{r}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{$6_{r}$};
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{$7_{r}$};

	\draw[->, very thick, >=latex] (maintopic) -- (first);
\end{tikzpicture}

\subsubsection*{8*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$8_{pr}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$3$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{$6$};
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{$7$};

	\draw[->, very thick, >=latex] (maintopic) -- (second);
\end{tikzpicture}

\subsubsection*{9*}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$8_{pr}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$9_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{$6$};
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{$7$};

	\draw[->, very thick, >=latex] (maintopic) -- (fourth);
\end{tikzpicture}

\subsubsection*{5}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$8_{pr}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$9_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$4$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{$6$};
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{$7$};

	\draw[->, very thick, >=latex] (maintopic) -- (fourth);
\end{tikzpicture}

\subsubsection*{10}
\begin{tikzpicture}
	\def \n {7}
	\def \radius {3cm}
	
	\node[] (maintopic) at (0:0) {};
	
	\node[draw, rectangle] (first)   at ({360/\n * 0 + 90}:\radius)
		{$8_{pr}$};
	\node[draw, rectangle] (second)  at ({360/\n * 6 + 90}:\radius) 
		{$2_{pr}$};
	\node[draw, rectangle] (third)   at ({360/\n * 5 + 90}:\radius) 
		{$9_{pr}$};
	\node[draw, rectangle] (fourth)  at ({360/\n * 4 + 90}:\radius) 
		{$10_{r}$};
	\node[draw, rectangle] (fifth)   at ({360/\n * 3 + 90}:\radius) 
		{$5_{pr}$};
	\node[draw, rectangle] (sixth)   at ({360/\n * 2 + 90}:\radius) 
		{$6$};
	\node[draw, rectangle] (seventh) at ({360/\n * 1 + 90}:\radius) 
		{$7$};

	\draw[->, very thick, >=latex] (maintopic) -- (fifth);
\end{tikzpicture}

}

\section*{Problem 2}

\begin{enumerate}
	\item Yes. Each entry in the index would contain the value of K1 (20 bytes)
			and a pointer to the corresponding record (8 bytes). The entire data
			file contains 20 million records, so the index file would contain 20
			million records, with each record being 28 bytes. Each block can
			contain $\lfloor 8,192 / 28 \rfloor = 292$ index records. The entire
			index would therefore be $\lceil 20,000,000 / 292 \rceil = 68,494$
			blocks.
	\item Yes. Each entry in the index would contain a pointer to the start of a
			block in the data file, and the value of K1 for the first record in
			that block. Since each block in the data file contains 20 records,
			you would need $1,000,000 / 20 = 50,000$ entries in the index, which
			would take up $\lceil 50,000 / 292 \rceil = 172$ blocks.
	\item Yes. Each entry in the index would contain the value of K2 (20 bytes)
			and a pointer to the corresponding record (8 bytes). The entire data
			file contains 20 million records, so the index file would be 28
			million bytes. Each block can contain $\lfloor 8,192 / 28 \rfloor =
			292$ index records. The entire index would therefore be $\lceil
			28,000,000 / 292 \rceil = 95,891$ blocks.
	\item No. You can't build a sparse index on an unsorted file, and since R is
			only sorted on K1 a sparse index on K2 would not work (unless R
			happens to also be sorted over K2, or if you sort the file over K2
			first).
	\item Yes. You can have a second-level sparse index on the index from (1).
			Each entry in the second-level index would contain a pointer to a
			block in the dense first-level index, and the value of the first key
			K1 in that block. Because the dense first-level index would contain
			68,494 blocks, the second-level index would have to contain 68,494
			entries, each 28 bytes long. This second-level index would take up
			$\lceil 68,494 / 292 \rceil = 235$ blocks. Combined with the size of
			the first-level index it would be $68,494 + 235 = 68,729$
			blocks.
	\item Yes. You can have a second-level sparse index on the index from (2).
			Each entry in the second-level index would contain a pointer to a
			block in the sparse first-level index, and the value of the first
			key K1 in that block. Because the sparse first-level index would
			contain 172 blocks, the second-level index would have to contain 172
			entries. This is small enough to fit in a single block. Combined
			with the size of the first level index, the total size would be $172
			+ 1 = 173$ blocks.
\end{enumerate}

\section*{Problem 3}

\begin{center}
\begin{tikzpicture}
	\tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle
		split parts=3, draw]
	\tikzstyle{edge from parent}=[draw=none]
	\tikzstyle{every node}=[bplus]
	\tikzstyle{level 1}=[sibling distance=18em]
	\tikzstyle{level 2}=[sibling distance=6em]

		\node[bplus, label={N1}] (root) {
		\nodepart{one} 13
		\nodepart{two} \hphantom{13}
		\nodepart{three} \hphantom{13}
	}
	child {
		node[label={N2}] (lv2a) {
			\nodepart{one} 7
			\nodepart{two} \hphantom{7}
			\nodepart{three} \hphantom{7}
		}
		child {node[label={N4}] (leafa) {1 \nodepart{two} 3 \nodepart{three} 5}}
		child {node[label={\hspace{1cm}N5}] (leafb) {7 \nodepart{two} 11
		\nodepart{three} }}
	}
	child {
		node[label={N3}] (lv2b) {
			\nodepart{one} 23
			\nodepart{two} 31
			\nodepart{three} 43
		}
		child {node[label={N6}] (leafc) {13 \nodepart{two} 17 \nodepart{three}
		19}}
		child {node[label={N7}] (leafd) {23 \nodepart{two} 29 \nodepart{three}
		}}
		child {node[label={\hspace{1cm}N8}] (leafe) {31 \nodepart{two} 37
		\nodepart{three} 41}}
		child {node[label={N9}] (leaff) {43 \nodepart{two} 47 \nodepart{three}}}
	};
	
		\draw [->, thick, >=latex] (root.one west) -- (lv2a);
		\draw [->, thick, >=latex] ($(root.one south) !.5! (root.two south)$) --
		(lv2b);
		\draw [->, thick, >=latex] (lv2a.one west) -- (leafa);
		\draw [->, thick, >=latex] ($(lv2a.one south) !.5! (lv2a.two south)$) --
		(leafb);
		\draw [->, thick, >=latex] (lv2b.one west) -- (leafc);
		\draw [->, thick, >=latex] ($(lv2b.one south) !.5! (lv2b.two south)$) --
		(leafd);
		\draw [->, thick, >=latex] ($(lv2b.two south) !.5! (lv2b.three south)$)
		-- (leafe);
		\draw [->, thick, >=latex] (lv2b.three east) -- (leaff);
\end{tikzpicture}
\end{center}

\subsubsection*{1.}

First the root note, N1, would be accessed, then the program would follow the
pointer to the right of the key 13 because $35 > 13$ to N3. From there, it would
follow the pointer between 31 and 43 to N8.  At N8 it would realize that the
search key 35 is not in the data file, because the leaf layer is dense.

\subsubsection*{2.}

First the root node, N1, would be accessed, then the program would follow the
pointer to the left of the key 13 because $9 < 35$ to N2.  From there, it would
follow the pointer to the right of key 7 to N5.  At N5, it would retrive the key
11, then follow the leaf pointer to N6. Here, it would retrieve keys 13, 17, and
19, then follow the leaf pointer to N7. At this point it would stop, since $23 >
21$.

\newgeometry{left=1cm,right=1cm,top=1in}

\subsubsection*{3.}

\begin{center}
\begin{tikzpicture}
	\tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle
		split parts=3, draw]
	\tikzstyle{edge from parent}=[draw=none]
	\tikzstyle{every node}=[bplus]
	\tikzstyle{level 1}=[sibling distance=18em]
	\tikzstyle{level 2}=[sibling distance=5em]

		\node[bplus, label={N1}] (root) {
		\nodepart{one} 13
		\nodepart{two} \hphantom{13}
		\nodepart{three} \hphantom{13}
	}
	child {
		node[label={N2}] (lv2a) {
			\nodepart{one} 3
			\nodepart{two} 7
			\nodepart{three} \hphantom{7}
		}
		child {node[label={N4}] (leafa) {1 \nodepart{two} 3 \nodepart{three} }}
		child {node[label={\hspace{-1mm}N10}] (leafg) {4 \nodepart{two} 5
		\nodepart{three} }}
		child {node[label={\hspace{1cm}N5}] (leafb) {7 \nodepart{two} 11
		\nodepart{three} }}
	}
	child {
		node[label={N3}] (lv2b) {
			\nodepart{one} 23
			\nodepart{two} 31
			\nodepart{three} 43
		}
		child {node[label={N6}] (leafc) {13 \nodepart{two} 17 \nodepart{three}
		19}}
		child {node[label={N7}] (leafd) {23 \nodepart{two} 29 \nodepart{three}
		}}
		child {node[label={\hspace{1cm}N8}] (leafe) {31 \nodepart{two} 37
		\nodepart{three} 41}}
		child {node[label={N9}] (leaff) {43 \nodepart{two} 47 \nodepart{three}}}
	};
	
		\draw [->, thick, >=latex] (root.one west) -- (lv2a);
		\draw [->, thick, >=latex] ($(root.one south) !.5! (root.two south)$) --
		(lv2b);
		\draw [->, thick, >=latex] (lv2a.one west) -- (leafa);
		\draw [->, thick, >=latex] ($(lv2a.one south) !.5! (lv2a.two south)$) --
		(leafg);
		\draw [->, thick, >=latex] (lv2b.one west) -- (leafc);
		\draw [->, thick, >=latex] ($(lv2b.one south) !.5! (lv2b.two south)$) --
		(leafd);
		\draw [->, thick, >=latex] ($(lv2b.two south) !.5! (lv2b.three south)$)
		-- (leafe);
		\draw [->, thick, >=latex] (lv2b.three east) -- (leaff);
		\draw [->, thick, >=latex] ($(lv2a.two south) !.5! (lv2a.three south)$)
		-- (leafb);
\end{tikzpicture}
\end{center}

\subsubsection*{4.}

After insertion of key 14:

\begin{center}
\begin{tikzpicture}
	\tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle
		split parts=3, draw]
	\tikzstyle{edge from parent}=[draw=none]
	\tikzstyle{every node}=[bplus]
	\tikzstyle{level 1}=[sibling distance=15em]
	\tikzstyle{level 2}=[sibling distance=5em]

		\node[bplus, label={N1}] (root) {
		\nodepart{one} 13
		\nodepart{two} 31
		\nodepart{three} \hphantom{13}
	}
	child {
		node[label={N2}] (lv2a) {
			\nodepart{one} 3
			\nodepart{two} 7
			\nodepart{three} \hphantom{7}
		}
		child {node[label={N4}] (leafa) {1 \nodepart{two} 3 \nodepart{three} }}
		child {node[label={\hspace{-1mm}N10}] (leafg) {4 \nodepart{two} 5
		\nodepart{three} }}
		child {node[label={\hspace{.5cm}N5}] (leafb) {7 \nodepart{two} 11
		\nodepart{three} }}
	}
	child{
		node[label={\hspace{-2mm}N12}] (lv2c) {
			\nodepart{one} 17
			\nodepart{two} 23
		}
		child {node[label={N6}] (leafc) {13 \nodepart{two} 14 \nodepart{three}}}
		child {node[label={N11}] (leafh) {17 \nodepart{two} 19 \nodepart{three}
		}}
		child {node[label={\hspace{5mm}N7}] (leafd) {23 \nodepart{two} 29 \nodepart{three}
		}}
	}
	child {
		node[label={N3}] (lv2b) {
			\nodepart{one} 43
			\nodepart{two} \hphantom{43}
			\nodepart{three} \hphantom{43}
		}
		child {node[label={\hspace{0pt}N8}] (leafe) {31 \nodepart{two} 37
		\nodepart{three} 41}}
		child {node[label={\hspace{1cm}N9}] (leaff) {43 \nodepart{two} 47
		\nodepart{three}}}
	};
	
		\draw [->, thick, >=latex] (root.one west) -- (lv2a);
		\draw [->, thick, >=latex] ($(root.one south) !.5! (root.two south)$) --
		(lv2c);
		\draw [->, thick, >=latex] ($(root.two south) !.5! (root.three south)$)
		-- (lv2b);
		\draw [->, thick, >=latex] (lv2a.one west) -- (leafa);
		\draw [->, thick, >=latex] ($(lv2a.one south) !.5! (lv2a.two south)$) --
		(leafg);
		\draw [->, thick, >=latex] (lv2b.one west) -- (leafe);
		\draw [->, thick, >=latex] ($(lv2b.one south) !.5! (lv2b.two south)$) --
		(leaff);
		\draw [->, thick, >=latex] ($(lv2a.two south) !.5! (lv2a.three south)$)
		-- (leafb);
		\draw [->, thick, >=latex] (lv2c.one west) -- (leafc);
		\draw [->, thick, >=latex] ($(lv2c.one south) !.5! (lv2c.two south)$)
		-- (leafh);
		\draw [->, thick, >=latex] ($(lv2c.two south) !.5! (lv2c.three south)$)
		-- (leafd);
\end{tikzpicture}
\end{center}

After insertion of key 15:

\begin{center}
\begin{tikzpicture}
	\tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle
		split parts=3, draw]
	\tikzstyle{edge from parent}=[draw=none]
	\tikzstyle{every node}=[bplus]
	\tikzstyle{level 1}=[sibling distance=15em]
	\tikzstyle{level 2}=[sibling distance=5em]

		\node[bplus, label={N1}] (root) {
		\nodepart{one} 13
		\nodepart{two} 31
		\nodepart{three} \hphantom{13}
	}
	child {
		node[label={N2}] (lv2a) {
			\nodepart{one} 3
			\nodepart{two} 7
			\nodepart{three} \hphantom{7}
		}
		child {node[label={N4}] (leafa) {1 \nodepart{two} 3 \nodepart{three} }}
		child {node[label={\hspace{-1mm}N10}] (leafg) {4 \nodepart{two} 5
		\nodepart{three} }}
		child {node[label={\hspace{.5cm}N5}] (leafb) {7 \nodepart{two} 11
		\nodepart{three} }}
	}
	child{
		node[label={\hspace{-2mm}N12}] (lv2c) {
			\nodepart{one} 17
			\nodepart{two} 23
		}
		child {node[label={N6}] (leafc) {13 \nodepart{two} 14 \nodepart{three}
		15}}
		child {node[label={N11}] (leafh) {17 \nodepart{two} 19 \nodepart{three}
		}}
		child {node[label={\hspace{5mm}N7}] (leafd) {23 \nodepart{two} 29 \nodepart{three}
		}}
	}
	child {
		node[label={N3}] (lv2b) {
			\nodepart{one} 43
			\nodepart{two} \hphantom{43}
			\nodepart{three} \hphantom{43}
		}
		child {node[label={\hspace{0pt}N8}] (leafe) {31 \nodepart{two} 37
		\nodepart{three} 41}}
		child {node[label={\hspace{1cm}N9}] (leaff) {43 \nodepart{two} 47
		\nodepart{three}}}
	};
	
		\draw [->, thick, >=latex] (root.one west) -- (lv2a);
		\draw [->, thick, >=latex] ($(root.one south) !.5! (root.two south)$) --
		(lv2c);
		\draw [->, thick, >=latex] ($(root.two south) !.5! (root.three south)$)
		-- (lv2b);
		\draw [->, thick, >=latex] (lv2a.one west) -- (leafa);
		\draw [->, thick, >=latex] ($(lv2a.one south) !.5! (lv2a.two south)$) --
		(leafg);
		\draw [->, thick, >=latex] (lv2b.one west) -- (leafe);
		\draw [->, thick, >=latex] ($(lv2b.one south) !.5! (lv2b.two south)$) --
		(leaff);
		\draw [->, thick, >=latex] ($(lv2a.two south) !.5! (lv2a.three south)$)
		-- (leafb);
		\draw [->, thick, >=latex] (lv2c.one west) -- (leafc);
		\draw [->, thick, >=latex] ($(lv2c.one south) !.5! (lv2c.two south)$)
		-- (leafh);
		\draw [->, thick, >=latex] ($(lv2c.two south) !.5! (lv2c.three south)$)
		-- (leafd);
\end{tikzpicture}
\end{center}

After insertion of key 16:

\begin{center}
\begin{tikzpicture}
	\tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle
		split parts=3, draw]
	\tikzstyle{edge from parent}=[draw=none]
	\tikzstyle{every node}=[bplus]
	\tikzstyle{level 1}=[sibling distance=17em]
	\tikzstyle{level 2}=[sibling distance=5em]

		\node[bplus, label={N1}] (root) {
		\nodepart{one} 13
		\nodepart{two} 31
		\nodepart{three} \hphantom{13}
	}
	child {
		node[label={N2}] (lv2a) {
			\nodepart{one} 3
			\nodepart{two} 7
			\nodepart{three} \hphantom{7}
		}
		child {node[label={N4}] (leafa) {1 \nodepart{two} 3 \nodepart{three} }}
		child {node[label={\hspace{-1mm}N10}] (leafg) {4 \nodepart{two} 5
		\nodepart{three} }}
		child {node[label={\hspace{.5cm}N5}] (leafb) {7 \nodepart{two} 11
		\nodepart{three} }}
	}
	child{
		node[label={\hspace{-2mm}N12}] (lv2c) {
			\nodepart{one} 15
			\nodepart{two} 17
			\nodepart{three} 23
		}
		child {node[label={N6}] (leafc) {13 \nodepart{two} 14 \nodepart{three}
		}}
		child {node[label={N13}] (leafi) {15 \nodepart{two} 16 \nodepart{three}
		}}
		child {node[label={\hspace{1.5cm}N11}] (leafh) {17 \nodepart{two} 19
		\nodepart{three} }}
		child {node[label={\hspace{5mm}N7}] (leafd) {23 \nodepart{two} 29
		\nodepart{three}
		}}
	}
	child {
		node[label={N3}] (lv2b) {
			\nodepart{one} 43
			\nodepart{two} \hphantom{43}
			\nodepart{three} \hphantom{43}
		}
		child {node[label={\hspace{0pt}N8}] (leafe) {31 \nodepart{two} 37
		\nodepart{three} 41}}
		child {node[label={\hspace{1cm}N9}] (leaff) {43 \nodepart{two} 47
		\nodepart{three}}}
	};
	
		\draw [->, thick, >=latex] (root.one west) -- (lv2a);
		\draw [->, thick, >=latex] ($(root.one south) !.5! (root.two south)$) --
		(lv2c);
		\draw [->, thick, >=latex] ($(root.two south) !.5! (root.three south)$)
		-- (lv2b);
		\draw [->, thick, >=latex] (lv2a.one west) -- (leafa);
		\draw [->, thick, >=latex] ($(lv2a.one south) !.5! (lv2a.two south)$) --
		(leafg);
		\draw [->, thick, >=latex] (lv2b.one west) -- (leafe);
		\draw [->, thick, >=latex] ($(lv2b.one south) !.5! (lv2b.two south)$) --
		(leaff);
		\draw [->, thick, >=latex] ($(lv2a.two south) !.5! (lv2a.three south)$)
		-- (leafb);
		\draw [->, thick, >=latex] (lv2c.one west) -- (leafc);
		\draw [->, thick, >=latex] ($(lv2c.one south) !.5! (lv2c.two south)$)
		-- (leafi);
		\draw [->, thick, >=latex] ($(lv2c.two south) !.5! (lv2c.three south)$)
		-- (leafh);
		\draw [->, thick, >=latex] (lv2c.three east) -- (leafd);
\end{tikzpicture}
\end{center}



\subsubsection*{5.}

Assuming we're still using the modified tree from the previous question, first
the root, N1, would be accessed, then the program would follow the pointer to
the left of 13 because $6 < 13$ to N2. From there, it would follow the pointer
between 3 and 7 to N10. Finding no keys in the range, it would follow the leaf
pointer right to N5, grabbing keys 7 and 11 from it. It would then continue
right to N13, where it would grab 13 and then exit.

\subsubsection*{6.}

Assuming we're still using the same tree from the previous questions, this is
the result of deleting key 23:

\begin{center}
\begin{tikzpicture}
	\tikzstyle{bplus}=[rectangle split, rectangle split horizontal, rectangle
		split parts=3, draw]
	\tikzstyle{edge from parent}=[draw=none]
	\tikzstyle{every node}=[bplus]
	\tikzstyle{level 1}=[sibling distance=17em]
	\tikzstyle{level 2}=[sibling distance=5em]

		\node[bplus, label={N1}] (root) {
		\nodepart{one} 13
		\nodepart{two} 31
		\nodepart{three} \hphantom{13}
	}
	child {
		node[label={N2}] (lv2a) {
			\nodepart{one} 3
			\nodepart{two} 7
			\nodepart{three} \hphantom{7}
		}
		child {node[label={N4}] (leafa) {1 \nodepart{two} 3 \nodepart{three} }}
		child {node[label={\hspace{-1mm}N10}] (leafg) {4 \nodepart{two} 5
		\nodepart{three} }}
		child {node[label={\hspace{.5cm}N5}] (leafb) {7 \nodepart{two} 11
		\nodepart{three} }}
	}
	child{
		node[label={\hspace{-2mm}N12}] (lv2c) {
			\nodepart{one} 15
			\nodepart{two} 17
			\nodepart{three} 23
		}
		child {node[label={N6}] (leafc) {13 \nodepart{two} 14 \nodepart{three}
		}}
		child {node[label={N13}] (leafi) {15 \nodepart{two} 16 \nodepart{three}
		}}
		child {node[label={\hspace{1.5cm}N11}] (leafh) {17 \nodepart{two} 19
		\nodepart{three} }}
		child {node[label={\hspace{5mm}N7}] (leafd) {29 \nodepart{two} 31
		\nodepart{three}
		}}
	}
	child {
		node[label={N3}] (lv2b) {
			\nodepart{one} 43
			\nodepart{two} \hphantom{43}
			\nodepart{three} \hphantom{43}
		}
		child {node[label={\hspace{0pt}N8}] (leafe) {37 \nodepart{two} 41
		\nodepart{three} }}
		child {node[label={\hspace{1cm}N9}] (leaff) {43 \nodepart{two} 47
		\nodepart{three}}}
	};
	
		\draw [->, thick, >=latex] (root.one west) -- (lv2a);
		\draw [->, thick, >=latex] ($(root.one south) !.5! (root.two south)$) --
		(lv2c);
		\draw [->, thick, >=latex] ($(root.two south) !.5! (root.three south)$)
		-- (lv2b);
		\draw [->, thick, >=latex] (lv2a.one west) -- (leafa);
		\draw [->, thick, >=latex] ($(lv2a.one south) !.5! (lv2a.two south)$) --
		(leafg);
		\draw [->, thick, >=latex] (lv2b.one west) -- (leafe);
		\draw [->, thick, >=latex] ($(lv2b.one south) !.5! (lv2b.two south)$) --
		(leaff);
		\draw [->, thick, >=latex] ($(lv2a.two south) !.5! (lv2a.three south)$)
		-- (leafb);
		\draw [->, thick, >=latex] (lv2c.one west) -- (leafc);
		\draw [->, thick, >=latex] ($(lv2c.one south) !.5! (lv2c.two south)$)
		-- (leafi);
		\draw [->, thick, >=latex] ($(lv2c.two south) !.5! (lv2c.three south)$)
		-- (leafh);
		\draw [->, thick, >=latex] (lv2c.three east) -- (leafd);
\end{tikzpicture}
\end{center}


\restoregeometry
\end{document}
